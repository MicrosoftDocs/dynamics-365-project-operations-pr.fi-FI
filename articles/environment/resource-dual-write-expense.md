---
title: Kulujen hallintaintegraatio
description: Tässä aiheessa on tietoja kuluraporttien integroinnista Project Operationsissa käyttämällä kaksoiskirjoitusta.
author: sigitac
ms.date: 04/28/2021
ms.topic: article
ms.prod: ''
ms.service: project-operations
ms.reviewer: kfend
ms.author: sigitac
ms.openlocfilehash: 8c347f14f3a479eb4aec951cfe4094c5581bce32
ms.sourcegitcommit: 02f00960198cc78a5e96955a9e4390c2c6393bbf
ms.translationtype: HT
ms.contentlocale: fi-FI
ms.lasthandoff: 04/28/2021
ms.locfileid: "5955741"
---
# <a name="expense-management-integration"></a><span data-ttu-id="6fdd5-103">Kulujen hallintaintegraatio</span><span class="sxs-lookup"><span data-stu-id="6fdd5-103">Expense management integration</span></span>

<span data-ttu-id="6fdd5-104">_**Käytetään:** Project Operationsin resursseihin ja ei-varastoitaviin perustuvissa skenaarioissa_</span><span class="sxs-lookup"><span data-stu-id="6fdd5-104">_**Applies To:** Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="6fdd5-105">Tässä aiheessa on tietoja kuluraporttien integroinnista Project Operationsissa [täysi kustannusten käyttöönotto](../expense/expense-overview.md) käyttämällä kaksoiskirjoitusta.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-105">This topic provides information about expense reports integration in Project Operations [full expense deployment](../expense/expense-overview.md) using dual-write.</span></span>

## <a name="expense-categories"></a><span data-ttu-id="6fdd5-106">Kululuokat</span><span class="sxs-lookup"><span data-stu-id="6fdd5-106">Expense categories</span></span>

<span data-ttu-id="6fdd5-107">Täydellisessä kulujen käyttöönotossa kululuokat luodaan ja ylläpidetään Finance and Operations -sovelluksissa.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-107">In a full expense deployment, expense categories are created and maintained in Finance and Operations apps.</span></span> <span data-ttu-id="6fdd5-108">Jos haluat luoda uuden kululuokan, toimi seuraavasti:</span><span class="sxs-lookup"><span data-stu-id="6fdd5-108">To create a new expense category, complete the following steps:</span></span>

1. <span data-ttu-id="6fdd5-109">Luo **tapahtuma**-luokka Microsoft Dataversessä.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-109">In Microsoft Dataverse, create a **Transaction** category.</span></span> <span data-ttu-id="6fdd5-110">Kaksoiskirjoitusintegrointi synkronoi tämän tapahtumaluokan Finance and Operations -sovelluksiin.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-110">Dual-write integration will synchronize this transaction category to Finance and Operations apps.</span></span> <span data-ttu-id="6fdd5-111">Lisätietoja on ohjeaiheessa [Projektiluokkien määrittäminen](/dynamics365/project-operations/project-accounting/configure-project-categories) ja [Projektitoimintojen määritysten ja määritystietojen integrointi](resource-dual-write-setup-integration.md).</span><span class="sxs-lookup"><span data-stu-id="6fdd5-111">For more information, see [Configure project categories](/dynamics365/project-operations/project-accounting/configure-project-categories) and [Project Operations setup and configuration data integration](resource-dual-write-setup-integration.md).</span></span> <span data-ttu-id="6fdd5-112">Tämän integroinnin tuloksena järjestelmä luo neljä jaettua luokkatietuetta Finance and Operations -sovelluksiin.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-112">As a result of this integration, the system creates four shared category records in Finance and Operations apps.</span></span>
2. <span data-ttu-id="6fdd5-113">Siirry Financessa kohtaan **Kulujen hallinta** > **Määritys** > **Jaetut luokat** ja valitse jaettu luokka, jolla on **Kulu**-tapahtumaluokka.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-113">In Finance, go to **Expense management** > **Setup** > **Shared categories** and select a shared category with an **Expense** transaction class.</span></span> <span data-ttu-id="6fdd5-114">Määritä **Voi käyttää kuluissa** -parametrin arvoksi **Tosi** ja määritä käytettävä kulutyyppi.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-114">Set the **Can be used in Expense** parameter to **True** and define the expense type to use.</span></span>
3. <span data-ttu-id="6fdd5-115">Luo tämän jaetun luokkatietueen avulla uusi kululuokka menemällä kohtaan **Kulujen hallinta** > **Määritys** > **Kululuokat** ja valitsemalla **Uusi**.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-115">Using this shared category record, create a new expense category by going to **Expense management** > **Setup** > **Expense categories** and selecting **New**.</span></span> <span data-ttu-id="6fdd5-116">Kun tietue tallennetaan, kaksoiskirjoitus käyttää taulukkokarttaa **Project Operationsin integrointiprojektin kululuokkien vientientiteetti (msdyn\_expensecategories)** tämän tietueen synkronoimiseen Dataverseen.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-116">When the record is saved, dual-write uses the table map, **Project Operations integration project expense categories export entity (msdyn\_expensecategories)** to synchronize this record to Dataverse.</span></span>

  ![Kululuokkien integrointi](./media/DW6ExpenseCategories.png)

<span data-ttu-id="6fdd5-118">Finance and Operations -sovellusten kululuokat ovat yritys- tai oikeushenkilökohtaisia.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-118">Expense categories in Finance and Operations apps are company- or legal entity-specific.</span></span> <span data-ttu-id="6fdd5-119">Dataversessä on erilliset, vastaavat oikeushenkilökohtaiset tietueet.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-119">There are separate, corresponding legal entity-specific records in Dataverse.</span></span> <span data-ttu-id="6fdd5-120">Kun projektipäällikkö arvioi kuluja, hän ei voi valita kululuokkia, jotka on luotu projektille, jonka omistaa eri yritys kuin se yritys, joka omistaa projektin, jota hän käyttää.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-120">When a project manager estimates expenses, they can’t select expense categories that were created for a project that is owned by a different company than the company that owns the project they are working on.</span></span> 

## <a name="expense-reports"></a><span data-ttu-id="6fdd5-121">Kuluraportit</span><span class="sxs-lookup"><span data-stu-id="6fdd5-121">Expense reports</span></span>

<span data-ttu-id="6fdd5-122">Kuluraportit luodaan ja hyväksytään Finance and Operations -sovelluksissa.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-122">Expense reports are created and approved in Finance and Operations apps.</span></span> <span data-ttu-id="6fdd5-123">Lisätietoja on kohdassa [Kuluraporttien luominen ja käsitteleminen Dynamics 365 Project Operationsissa](/learn/modules/create-process-expense-reports/).</span><span class="sxs-lookup"><span data-stu-id="6fdd5-123">For more information, see [Create and process expense reports in Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span></span> <span data-ttu-id="6fdd5-124">Kun projektipäällikkö on hyväksynyt kuluraportin, se kirjataan pääkirjanpitoon.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-124">After the expense report is approved by the Project manager, it's posted to the general ledger.</span></span> <span data-ttu-id="6fdd5-125">Project Operationsissa projektiin liittyvät kuluraporttirivit kirjataan käyttämällä erityisiä kirjaussääntöjä:</span><span class="sxs-lookup"><span data-stu-id="6fdd5-125">In Project Operations, project-related expense report lines are posted using special posting rules:</span></span>

  - <span data-ttu-id="6fdd5-126">Projektiin liittyvää kustannusta (mukaan lukien ei-palautettavissa oleva vero) ei kirjata heti projektin kustannustilille pääkirjaan, vaan se kirjataan kulujen integrointitilille.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-126">Project-related cost (including non-recoverable tax) is not immediately posted to project cost account in general ledger, but instead is posted to expense integration account.</span></span> <span data-ttu-id="6fdd5-127">Tämä asiakas on määritetty **Projektinhallinta ja kirjanpito** > **Määrittäminen** > **Projektinhallinta- ja kirjanpitoparametrit**, **Project Operations Dynamics 365 Customer engagementissa** -välilehdellä.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-127">This account is configured in **Project management and accounting** > **Setup** > **Project management and accounting parameters**, **Project Operations on Dynamics 365 Customer engagement** tab.</span></span>
  - <span data-ttu-id="6fdd5-128">Kaksoiskirjoitus synkronoi Dataverseen käyttämällä **Project Operations -integrointiprojektin kulujen vientientiteetti (msdyn\_kulujen)** -taulukkokartan kanssa.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-128">Dual-write synchronizes to Dataverse using **Project Operations integration project expenses export entity (msdyn\_expenses)** table map.</span></span>
  - <span data-ttu-id="6fdd5-129">Verojen alareskontra, toimittajan alareskontra ja muut taloudelliset kirjaukset kirjataan kuluraporttien kirjausten yhteydessä soveltuvin osin.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-129">Tax subledger, vendor subledger, and other financial postings are recorded as applicable at the time of expense report posting.</span></span>

  ![Matkalaskujen integrointi](./media/DW6ExpenseReports.png)

<span data-ttu-id="6fdd5-131">Kun tietue kirjoitetaan **Kulu**-kohteeseen Dataverse -järjestelmässä, järjestelmä käynnistää tietueen automaattisen hyväksyntäprosessin.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-131">When a record is written to the **Expense** entity in Dataverse, the system triggers the automated approval process of the record.</span></span> <span data-ttu-id="6fdd5-132">Jos tarpeen, automaattisen hyväksyntäprosessin tilan voi tarkistaa Dataversessä kohdassa **Lisäasetukset** > **Järjestelmä** > **Järjestelmätyöt**.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-132">If needed, the automated approval process status can be reviewed in Dataverse by going to **Advanced settings** > **System** > **System jobs**.</span></span> <span data-ttu-id="6fdd5-133">Kun hyväksyntä on valmis, kulutapahtumien luokkatietueet luodaan **Toteutuneet**-entiteettiin.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-133">After approval is complete, expense transaction class records are created in the **Actuals** entity.</span></span>

<span data-ttu-id="6fdd5-134">Tämän jälkeen kuluihin liittyvät toteutuneet tiedot käsitellään käyttämällä **Project Operationsin integrointien toteutuneet (msdyn\_actuals)** -kaksoiskirjoitustaulukkokarttaa.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-134">Expense related actuals are then processed using the dual-write table map **Project Operations integration actuals (msdyn\_actuals)**.</span></span> <span data-ttu-id="6fdd5-135">Lisätietoja on aiheissa [Projektin arviot ja todelliset kulut](resource-dual-write-estimates-actuals.md).</span><span class="sxs-lookup"><span data-stu-id="6fdd5-135">For more information, see [Project estimates and actuals](resource-dual-write-estimates-actuals.md).</span></span>

<span data-ttu-id="6fdd5-136">Jaksottainen prosessi, **Tuonti valmistelusta** luo kuluraporttiin liittyvät kirjausrivit Project Operationsin integrointi -kirjauskansioon.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-136">The periodic process, **Import from staging** creates Expense report-related journal lines in the Project Operations Integration journal.</span></span> <span data-ttu-id="6fdd5-137">Siirtymätilin oletusarvona on kulujen integrointitili.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-137">The offset account defaults to the expense integration account.</span></span> <span data-ttu-id="6fdd5-138">Integrointikirjauksen julkaisu tyhjentää kulutapahtuman tilisaldon ja siirtää kulusumman projektin kustannustilille.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-138">The Posting integration journal clears the account balance for the expense transaction and moves the expense amount to the project cost account.</span></span> <span data-ttu-id="6fdd5-139">Järjestelmä luo myös projektin alareskontratapahtumia laskutusta ja tuottojen kirjaamista varten.</span><span class="sxs-lookup"><span data-stu-id="6fdd5-139">The system also creates project subledger transactions for downstream invoicing and revenue recognition purposes.</span></span>
